"use strict";(self.webpackChunkjustin_csd=self.webpackChunkjustin_csd||[]).push([[9156],{28453:(s,n,e)=>{e.d(n,{R:()=>t,x:()=>m});var a=e(96540);const i={},l=a.createContext(i);function t(s){const n=a.useContext(l);return a.useMemo((function(){return"function"==typeof s?s(n):{...n,...s}}),[n,s])}function m(s){let n;return n=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:t(s.components),a.createElement(l.Provider,{value:n},s.children)}},77239:(s,n,e)=>{e.r(n),e.d(n,{assets:()=>c,contentTitle:()=>m,default:()=>d,frontMatter:()=>t,metadata:()=>a,toc:()=>r});const a=JSON.parse('{"id":"\u7f16\u7a0b \xb7 \u7287\u7287/\u57fa\u672c\u7b97\u6cd5/\u6742\u9879\u548c\u4e13\u9898/\u83ab\u961f\u7b97\u6cd5/mo-algo-on-tree","title":"\u6811\u4e0a\u83ab\u961f\u7b97\u6cd5","description":"\u62ec\u53f7\u5e8f\u6811\u4e0a\u83ab\u961f","source":"@site/docs/\u7f16\u7a0b \xb7 \u7287\u7287/\u57fa\u672c\u7b97\u6cd5/\u6742\u9879\u548c\u4e13\u9898/\u83ab\u961f\u7b97\u6cd5/mo-algo-on-tree.md","sourceDirName":"\u7f16\u7a0b \xb7 \u7287\u7287/\u57fa\u672c\u7b97\u6cd5/\u6742\u9879\u548c\u4e13\u9898/\u83ab\u961f\u7b97\u6cd5","slug":"/\u7f16\u7a0b \xb7 \u7287\u7287/\u57fa\u672c\u7b97\u6cd5/\u6742\u9879\u548c\u4e13\u9898/\u83ab\u961f\u7b97\u6cd5/mo-algo-on-tree","permalink":"/csd.io/docs/\u7f16\u7a0b \xb7 \u7287\u7287/\u57fa\u672c\u7b97\u6cd5/\u6742\u9879\u548c\u4e13\u9898/\u83ab\u961f\u7b97\u6cd5/mo-algo-on-tree","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"oiSidebar","previous":{"title":"\u4e8c\u7ef4\u83ab\u961f\u7b97\u6cd5","permalink":"/csd.io/docs/\u7f16\u7a0b \xb7 \u7287\u7287/\u57fa\u672c\u7b97\u6cd5/\u6742\u9879\u548c\u4e13\u9898/\u83ab\u961f\u7b97\u6cd5/mo-algo-2dimen"},"next":{"title":"\u83ab\u961f\u4e8c\u6b21\u79bb\u7ebf","permalink":"/csd.io/docs/\u7f16\u7a0b \xb7 \u7287\u7287/\u57fa\u672c\u7b97\u6cd5/\u6742\u9879\u548c\u4e13\u9898/\u83ab\u961f\u7b97\u6cd5/mo-algo-secondary-offline"}}');var i=e(74848),l=e(28453);const t={},m="\u6811\u4e0a\u83ab\u961f\u7b97\u6cd5",c={},r=[{value:"\u62ec\u53f7\u5e8f\u6811\u4e0a\u83ab\u961f",id:"\u62ec\u53f7\u5e8f\u6811\u4e0a\u83ab\u961f",level:2},{value:"\u8fc7\u7a0b",id:"\u8fc7\u7a0b",level:3},{value:"\u4f8b\u9898",id:"\u4f8b\u9898",level:3},{value:"\u8fc7\u7a0b",id:"\u8fc7\u7a0b-1",level:4},{value:"\u5b9e\u73b0",id:"\u5b9e\u73b0",level:4},{value:"\u771f\xb7\u6811\u4e0a\u83ab\u961f",id:"\u771f\u6811\u4e0a\u83ab\u961f",level:2},{value:"\u8be2\u95ee\u7684\u6392\u5e8f",id:"\u8be2\u95ee\u7684\u6392\u5e8f",level:3},{value:"\u6307\u9488\u7684\u79fb\u52a8",id:"\u6307\u9488\u7684\u79fb\u52a8",level:3},{value:"\u8fc7\u7a0b",id:"\u8fc7\u7a0b-2",level:4},{value:"\u5b9e\u73b0",id:"\u5b9e\u73b0-1",level:4},{value:"\u65f6\u95f4\u590d\u6742\u5ea6",id:"\u65f6\u95f4\u590d\u6742\u5ea6",level:3},{value:"\u4f8b\u9898\u300cWC2013\u300d\u7cd6\u679c\u516c\u56ed",id:"\u4f8b\u9898wc2013\u7cd6\u679c\u516c\u56ed",level:3}];function h(s){const n={a:"a",admonition:"admonition",annotation:"annotation",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",math:"math",mdxAdmonitionTitle:"mdxAdmonitionTitle",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",msubsup:"msubsup",msup:"msup",p:"p",pre:"pre",semantics:"semantics",span:"span",ul:"ul",...(0,l.R)(),...s.components},{Details:e}=n;return e||function(s,n){throw new Error("Expected "+(n?"component":"object")+" `"+s+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u6811\u4e0a\u83ab\u961f\u7b97\u6cd5",children:"\u6811\u4e0a\u83ab\u961f\u7b97\u6cd5"})}),"\n",(0,i.jsx)(n.h2,{id:"\u62ec\u53f7\u5e8f\u6811\u4e0a\u83ab\u961f",children:"\u62ec\u53f7\u5e8f\u6811\u4e0a\u83ab\u961f"}),"\n",(0,i.jsx)(n.p,{children:"\u4e00\u822c\u7684\u83ab\u961f\u53ea\u80fd\u5904\u7406\u7ebf\u6027\u95ee\u9898\uff0c\u6211\u4eec\u8981\u628a\u6811\u5f3a\u884c\u538b\u6210\u5e8f\u5217\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u4eec\u53ef\u4ee5\u5c06\u6811\u7684\u62ec\u53f7\u5e8f\u8dd1\u4e0b\u6765\uff0c\u628a\u62ec\u53f7\u5e8f\u5206\u5757\uff0c\u5728\u62ec\u53f7\u5e8f\u4e0a\u8dd1\u83ab\u961f\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5177\u4f53\u600e\u4e48\u505a\u5462\uff1f"}),"\n",(0,i.jsx)(n.h3,{id:"\u8fc7\u7a0b",children:"\u8fc7\u7a0b"}),"\n",(0,i.jsxs)(n.p,{children:["dfs \u4e00\u68f5\u6811\uff0c\u7136\u540e\u5982\u679c dfs \u5230 x \u70b9\uff0c\u5c31 ",(0,i.jsx)(n.code,{children:"push_back(x)"}),"\uff0cdfs \u5b8c x \u70b9\uff0c\u5c31\u76f4\u63a5 ",(0,i.jsx)(n.code,{children:"push_back(-x)"}),"\uff0c\u7136\u540e\u6211\u4eec\u5728\u632a\u52a8\u6307\u9488\u7684\u65f6\u5019\uff0c"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u65b0\u52a0\u5165\u7684\u503c\u662f x  ---\x3e",(0,i.jsx)(n.code,{children:"add(x)"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u65b0\u52a0\u5165\u7684\u503c\u662f - x ---\x3e",(0,i.jsx)(n.code,{children:"del(x)"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u65b0\u5220\u9664\u7684\u503c\u662f x  ---\x3e",(0,i.jsx)(n.code,{children:"del(x)"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u65b0\u5220\u9664\u7684\u503c\u662f - x ---\x3e",(0,i.jsx)(n.code,{children:"add(x)"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u6837\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u628a\u4e00\u68f5\u6811\u5904\u7406\u6210\u4e86\u5e8f\u5217\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u4f8b\u9898",children:"\u4f8b\u9898"}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsxs)(n.mdxAdmonitionTitle,{children:["\u4f8b\u9898 ",(0,i.jsx)(n.a,{href:"https://uoj.ac/problem/58",children:"\u300cWC2013\u300d\u7cd6\u679c\u516c\u56ed"})]}),(0,i.jsxs)(n.p,{children:["\u9898\u610f\uff1a\u7ed9\u4f60\u4e00\u68f5\u6811\uff0c\u6811\u4e0a\u7b2c ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsx)(n.mi,{children:"i"})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"i"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6595em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"i"})]})})]})," \u4e2a\u70b9\u989c\u8272\u4e3a ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"c"}),(0,i.jsx)(n.mi,{children:"i"})]})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"c_i"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",children:"c"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})})]}),"\uff0c\u6bcf\u6b21\u8be2\u95ee\u4e00\u6761\u8def\u5f84 ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mi,{children:"i"})]})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"u_i"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})})]}),",",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"v"}),(0,i.jsx)(n.mi,{children:"i"})]})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"v_i"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})})]}),", \u6c42\u8fd9\u6761\u8def\u5f84\u4e0a\u7684"]}),(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mo,{children:"\u2211"}),(0,i.jsx)(n.mi,{children:"c"})]}),(0,i.jsx)(n.mi,{children:"v"}),(0,i.jsx)(n.mi,{children:"a"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"l"}),(0,i.jsx)(n.mi,{children:"c"})]}),(0,i.jsxs)(n.msubsup,{children:[(0,i.jsx)(n.mo,{children:"\u2211"}),(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsx)(n.mo,{children:"="}),(0,i.jsx)(n.mn,{children:"1"})]}),(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"c"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"t"}),(0,i.jsx)(n.mi,{children:"c"})]})]})]}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"w"}),(0,i.jsx)(n.mi,{children:"i"})]})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\sum_{c}val_c\\sum_{i=1}^{cnt_c}w_i"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1.2332em",verticalAlign:"-0.2997em"}}),(0,i.jsxs)(n.span,{className:"mop",children:[(0,i.jsx)(n.span,{className:"mop op-symbol small-op",style:{position:"relative",top:"0em"},children:"\u2211"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.0017em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.4003em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"c"})})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.2997em"},children:(0,i.jsx)(n.span,{})})})]})})]}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"a"}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0197em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"c"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(n.span,{className:"mop",children:[(0,i.jsx)(n.span,{className:"mop op-symbol small-op",style:{position:"relative",top:"0em"},children:"\u2211"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsxs)(n.span,{className:"vlist",style:{height:"0.9335em"},children:[(0,i.jsxs)(n.span,{style:{top:"-2.4003em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(n.span,{className:"mrel mtight",children:"="}),(0,i.jsx)(n.span,{className:"mord mtight",children:"1"})]})})]}),(0,i.jsxs)(n.span,{style:{top:"-3.2029em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"c"}),(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"n"}),(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.1645em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.357em",marginLeft:"0em",marginRight:"0.0714em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.5em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size3 size1 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"c"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.143em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})})]})]}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.2997em"},children:(0,i.jsx)(n.span,{})})})]})})]}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"},children:"w"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})})]})}),(0,i.jsxs)(n.p,{children:["\u5176\u4e2d\uff1a",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"v"}),(0,i.jsx)(n.mi,{children:"a"}),(0,i.jsx)(n.mi,{children:"l"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"val"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"})]})})]})," \u8868\u793a\u8be5\u989c\u8272\u7684\u4ef7\u503c\uff0c",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"c"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mi,{children:"t"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"cnt"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6151em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"c"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"n"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"t"})]})})]})," \u8868\u793a\u989c\u8272\u51fa\u73b0\u7684\u6b21\u6570\uff0c",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsx)(n.mi,{children:"w"})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"w"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"},children:"w"})]})})]})," \u8868\u793a\u8be5\u989c\u8272\u51fa\u73b0 ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsx)(n.mi,{children:"i"})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"i"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6595em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"i"})]})})]})," \u6b21\u540e\u7684\u4ef7\u503c"]})]}),"\n",(0,i.jsx)(n.h4,{id:"\u8fc7\u7a0b-1",children:"\u8fc7\u7a0b"}),"\n",(0,i.jsxs)(n.p,{children:["\u5148\u628a\u6811\u53d8\u6210\u5e8f\u5217\uff0c\u7136\u540e\u6bcf\u6b21\u6dfb\u52a0/\u5220\u9664\u4e00\u4e2a\u70b9\uff0c\u8fd9\u4e2a\u70b9\u7684\u5bf9\u7b54\u6848\u7684\u7684\u8d21\u732e\u662f\u53ef\u4ee5\u5728 ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"O"}),(0,i.jsx)(n.mo,{stretchy:"false",children:"("}),(0,i.jsx)(n.mn,{children:"1"}),(0,i.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"O(1)"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),(0,i.jsx)(n.span,{className:"mopen",children:"("}),(0,i.jsx)(n.span,{className:"mord",children:"1"}),(0,i.jsx)(n.span,{className:"mclose",children:")"})]})})]})," \u65f6\u95f4\u5185\u83b7\u5f97\u7684\uff0c\u5373 ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"v"}),(0,i.jsx)(n.mi,{children:"a"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"l"}),(0,i.jsx)(n.mi,{children:"c"})]}),(0,i.jsx)(n.mo,{children:"\xd7"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"w"}),(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"c"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"t"}),(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"c"}),(0,i.jsx)(n.mo,{children:"+"}),(0,i.jsx)(n.mn,{children:"1"})]})]})]})]})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"val_c\\times w_{cnt_{c+1}}"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.8444em",verticalAlign:"-0.15em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"a"}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0197em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"c"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.7223em",verticalAlign:"-0.2918em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"},children:"w"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.2806em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"c"}),(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"n"}),(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.3173em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.357em",marginLeft:"0em",marginRight:"0.0714em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.5em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size3 size1 mtight",children:(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"c"}),(0,i.jsx)(n.span,{className:"mbin mtight",children:"+"}),(0,i.jsx)(n.span,{className:"mord mtight",children:"1"})]})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.2025em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.2918em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"\u53d1\u73b0\u56e0\u4e3a\u4ed6\u4f1a\u628a\u8d77\u70b9\u7684\u5b50\u6811\u4e5f\u626b\u4e86\u4e00\u904d\uff0c\u4ea7\u751f\u591a\u4f59\u7684\u8d21\u732e\uff0c\u600e\u4e48\u529e\u5462\uff1f"}),"\n",(0,i.jsx)(n.p,{children:"\u56e0\u4e3a\u626b\u7684\u8fc7\u7a0b\u4e2d\u8d77\u70b9\u7684\u5b50\u6811\u91cc\u7684\u70b9\u80af\u5b9a\u4f1a\u88ab\u626b\u4e24\u6b21\uff0c\u4f46\u8d21\u732e\u4e3a 0\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u6240\u4ee5\u53ef\u4ee5\u5f00\u4e00\u4e2a ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"v"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsx)(n.mi,{children:"s"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"vis"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6595em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"s"})]})})]})," \u6570\u7ec4\uff0c\u6bcf\u6b21\u626b\u5230\u70b9 x\uff0c\u5c31\u628a ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"v"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"s"}),(0,i.jsx)(n.mi,{children:"x"})]})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"vis_x"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.8095em",verticalAlign:"-0.15em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"i"}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",children:"s"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"x"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})})]})," \u5f02\u6216\u4e0a 1\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679c ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"v"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"s"}),(0,i.jsx)(n.mi,{children:"x"})]}),(0,i.jsx)(n.mo,{children:"="}),(0,i.jsx)(n.mn,{children:"0"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"vis_x=0"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.8095em",verticalAlign:"-0.15em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"i"}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",children:"s"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"x"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(n.span,{className:"mrel",children:"="}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(n.span,{className:"mord",children:"0"})]})]})]}),"\uff0c\u90a3\u8fd9\u4e2a\u70b9\u7684\u8d21\u732e\u5c31\u53ef\u4ee5\u4e0d\u8ba1\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u6240\u4ee5\u53ef\u4ee5\u7528\u6811\u4e0a\u83ab\u961f\u6765\u6c42\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u4fee\u6539\u7684\u8bdd\uff0c\u52a0\u4e0a\u4e00\u7ef4\u65f6\u95f4\u7ef4\u5373\u53ef\uff0c\u53d8\u6210\u5e26\u4fee\u6539\u6811\u4e0a\u83ab\u961f\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540e\u56e0\u4e3a\u6240\u5305\u542b\u7684\u533a\u95f4\u5185\u53ef\u80fd\u6ca1\u6709 LCA\uff0c\u5bf9\u4e8e\u6ca1\u6709\u7684\u60c5\u51b5\u8981\u5c06\u591a\u4f59\u7684\u8d21\u732e\u5220\u9664\uff0c\u7136\u540e\u5c31\u5b8c\u4e8b\u4e86\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u5b9e\u73b0",children:"\u5b9e\u73b0"}),"\n",(0,i.jsxs)(e,{children:[(0,i.jsx)("summary",{children:"\u53c2\u8003\u4ee3\u7801"}),(0,i.jsx)(n.admonition,{title:"\u53c2\u8003\u4ee3\u7801",type:"info",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'#include <algorithm>\n#include <cmath>\n#include <cstdio>\nusing namespace std;\n\nconstexpr int MAXN = 200010;\n\nint f[MAXN], g[MAXN], id[MAXN], head[MAXN], cnt, last[MAXN], dep[MAXN],\n    fa[MAXN][22], v[MAXN], w[MAXN];\nint block, index, n, m, q;\nint pos[MAXN], col[MAXN], app[MAXN];\nbool vis[MAXN];\nlong long ans[MAXN], cur;\n\nstruct edge {\n  int to, nxt;\n} e[MAXN];\n\nint cnt1 = 0, cnt2 = 0;  // \u65f6\u95f4\u6233\n\nstruct query {\n  int l, r, t, id;\n\n  bool operator<(const query &b) const {\n    return (pos[l] < pos[b.l]) || (pos[l] == pos[b.l] && pos[r] < pos[b.r]) ||\n           (pos[l] == pos[b.l] && pos[r] == pos[b.r] && t < b.t);\n  }\n} a[MAXN], b[MAXN];\n\nvoid addedge(int x, int y) {\n  e[++cnt] = edge{y, head[x]};\n  head[x] = cnt;\n}\n\nvoid dfs(int x) {\n  id[f[x] = ++index] = x;\n  for (int i = head[x]; i; i = e[i].nxt) {\n    if (e[i].to != fa[x][0]) {\n      fa[e[i].to][0] = x;\n      dep[e[i].to] = dep[x] + 1;\n      dfs(e[i].to);\n    }\n  }\n  id[g[x] = ++index] = x;  // \u62ec\u53f7\u5e8f\n}\n\nint lca(int x, int y) {\n  if (dep[x] < dep[y]) swap(x, y);\n  if (dep[x] != dep[y]) {  // \u722c\u5230\u540c\u4e00\u9ad8\u5ea6\n    int dis = dep[x] - dep[y];\n    for (int i = 20; i >= 0; i--)\n      if (dis >= (1 << i)) dis -= 1 << i, x = fa[x][i];\n  }\n  if (x == y) return x;\n  for (int i = 20; i >= 0; i--) {\n    if (fa[x][i] != fa[y][i]) x = fa[x][i], y = fa[y][i];\n  }\n  return fa[x][0];\n}\n\nvoid add(int x) {\n  if (vis[x])\n    cur -= (long long)v[col[x]] * w[app[col[x]]--];\n  else\n    cur += (long long)v[col[x]] * w[++app[col[x]]];\n  vis[x] ^= 1;\n}\n\n// \u5728\u65f6\u95f4\u7ef4\u4e0a\u79fb\u52a8\nvoid modify(int x, int t) {\n  if (vis[x]) {\n    add(x);\n    col[x] = t;\n    add(x);\n  } else\n    col[x] = t;\n}\n\nint main() {\n  scanf("%d%d%d", &n, &m, &q);\n  for (int i = 1; i <= m; i++) scanf("%d", &v[i]);\n  for (int i = 1; i <= n; i++) scanf("%d", &w[i]);\n  for (int i = 1; i < n; i++) {\n    int x, y;\n    scanf("%d%d", &x, &y);\n    addedge(x, y);\n    addedge(y, x);\n  }\n  for (int i = 1; i <= n; i++) {\n    scanf("%d", &last[i]);\n    col[i] = last[i];\n  }\n  dfs(1);\n  for (int j = 1; j <= 20; j++)\n    for (int i = 1; i <= n; i++)\n      fa[i][j] = fa[fa[i][j - 1]][j - 1];  // \u9884\u5904\u7406\u7956\u5148\n  int block = pow(index, 2.0 / 3);\n  for (int i = 1; i <= index; i++) {\n    pos[i] = (i - 1) / block;\n  }\n  while (q--) {\n    int opt, x, y;\n    scanf("%d%d%d", &opt, &x, &y);\n    if (opt == 0) {\n      b[++cnt2].l = x;\n      b[cnt2].r = last[x];\n      last[x] = b[cnt2].t = y;\n    } else {\n      if (f[x] > f[y]) swap(x, y);\n      a[++cnt1] = query{lca(x, y) == x ? f[x] : g[x], f[y], cnt2, cnt1};\n    }\n  }\n  sort(a + 1, a + cnt1 + 1);\n  int L, R, T;  // \u6307\u9488\u5750\u6807\n  L = R = 0;\n  T = 1;\n  for (int i = 1; i <= cnt1; i++) {\n    while (T <= a[i].t) {\n      modify(b[T].l, b[T].t);\n      T++;\n    }\n    while (T > a[i].t) {\n      modify(b[T].l, b[T].r);\n      T--;\n    }\n    while (L > a[i].l) {\n      L--;\n      add(id[L]);\n    }\n    while (L < a[i].l) {\n      add(id[L]);\n      L++;\n    }\n    while (R > a[i].r) {\n      add(id[R]);\n      R--;\n    }\n    while (R < a[i].r) {\n      R++;\n      add(id[R]);\n    }\n    int x = id[L], y = id[R];\n    int llca = lca(x, y);\n    if (x != llca && y != llca) {\n      add(llca);\n      ans[a[i].id] = cur;\n      add(llca);\n    } else\n      ans[a[i].id] = cur;\n  }\n  for (int i = 1; i <= cnt1; i++) {\n    printf("%lld\\n", ans[i]);\n  }\n  return 0;\n}\n'})})})]}),"\n",(0,i.jsx)(n.h2,{id:"\u771f\u6811\u4e0a\u83ab\u961f",children:"\u771f\xb7\u6811\u4e0a\u83ab\u961f"}),"\n",(0,i.jsx)(n.p,{children:"\u4e0a\u9762\u7684\u6811\u4e0a\u83ab\u961f\u53ea\u662f\u5c06\u6811\u8f6c\u5316\u6210\u4e86\u94fe\uff0c\u4e0b\u9762\u7684\u624d\u662f\u771f\u6b63\u7684\u6811\u4e0a\u83ab\u961f\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7531\u4e8e\u83ab\u961f\u76f8\u5173\u7684\u95ee\u9898\u90fd\u662f\u6a21\u677f\u9898\uff0c\u56e0\u6b64\u5b9e\u73b0\u90e8\u5206\u4e0d\u505a\u592a\u591a\u89e3\u91ca"}),"\n",(0,i.jsx)(n.h3,{id:"\u8be2\u95ee\u7684\u6392\u5e8f",children:"\u8be2\u95ee\u7684\u6392\u5e8f"}),"\n",(0,i.jsx)(n.p,{children:"\u9996\u5148\u6211\u4eec\u77e5\u9053\u83ab\u961f\u7684\u662f\u57fa\u4e8e\u5206\u5757\u7684\u7b97\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u627e\u5230\u4e00\u79cd\u6811\u4e0a\u7684\u5206\u5757\u65b9\u6cd5\u6765\u4fdd\u8bc1\u65f6\u95f4\u590d\u6742\u5ea6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6761\u4ef6\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5c5e\u4e8e\u540c\u4e00\u5757\u7684\u8282\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u4e0d\u8d85\u8fc7\u7ed9\u5b9a\u5757\u7684\u5927\u5c0f"}),"\n",(0,i.jsx)(n.li,{children:"\u6bcf\u4e2a\u5757\u4e2d\u7684\u8282\u70b9\u4e0d\u80fd\u592a\u591a\u4e5f\u4e0d\u80fd\u592a\u5c11"}),"\n",(0,i.jsx)(n.li,{children:"\u6bcf\u4e2a\u8282\u70b9\u90fd\u8981\u5c5e\u4e8e\u4e00\u4e2a\u5757"}),"\n",(0,i.jsx)(n.li,{children:"\u7f16\u53f7\u76f8\u90bb\u7684\u5757\u4e4b\u95f4\u7684\u8ddd\u79bb\u4e0d\u80fd\u592a\u5927"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u4e86\u89e3\u4e86\u8fd9\u4e9b\u6761\u4ef6\u540e\uff0c\u6211\u4eec\u770b\u5230\u8fd9\u6837\u4e00\u9053\u9898 ",(0,i.jsx)(n.a,{href:"https://loj.ac/problem/2152",children:"\u300cSCOI2005\u300d\u738b\u5ba4\u8054\u90a6"}),"\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u8fd9\u9053\u9898\u7684\u57fa\u7840\u4e0a\u6211\u4eec\u53ea\u8981\u4fdd\u8bc1\u6700\u540e\u4e00\u4e2a\u6761\u4ef6\u5c31\u53ef\u4ee5\u89e3\u51b3\u5206\u5757\u7684\u95ee\u9898\u4e86\u3002"}),"\n",(0,i.jsx)(n.admonition,{title:"\u601d\u8def",type:"note",children:(0,i.jsx)(n.p,{children:"\u4ee4 lim \u4e3a\u5e0c\u671b\u5757\u7684\u5927\u5c0f\uff0c\u9996\u5148\uff0c\u5bf9\u4e8e\u6574\u4e2a\u6811 dfs\uff0c\u5f53\u5b50\u6811\u7684\u5927\u5c0f\u5927\u4e8e lim \u65f6\uff0c\u5c31\u5c06\u5b83\u4eec\u5206\u5728\u4e00\u5757\uff0c\u5bb9\u6613\u60f3\u5230\uff1a\u5bf9\u4e8e\u6839\uff0c\u53ef\u80fd\u4f1a\u5269\u4e0b\u4e00\u4e9b\u70b9\uff0c\u4e8e\u662f\u5c06\u8fd9\u4e9b\u70b9\u5206\u5728\u6700\u540e\u4e00\u4e2a\u5757\u91cc\u3002"})}),"\n",(0,i.jsx)(n.p,{children:"\u505a\u6cd5\uff1a\u7528\u6808\u7ef4\u62a4\u5f53\u524d\u8282\u70b9\u4f5c\u4e3a\u7236\u8282\u70b9\u8bbf\u95ee\u5b83\u7684\u5b50\u8282\u70b9\uff0c\u5f53\u4ece\u6808\u9876\u5230\u7236\u8282\u70b9\u7684\u8ddd\u79bb\u5927\u4e8e\u5e0c\u671b\u5757\u7684\u5927\u5c0f\u65f6\uff0c\u5f39\u51fa\u8fd9\u90e8\u5206\u5143\u7d20\u5206\u4e3a\u4e00\u5757\uff0c\u6700\u540e\u5269\u4f59\u7684\u4e00\u5757\u5355\u72ec\u4f5c\u4e3a\u4e00\u5757\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u540e\u7684\u6392\u5e8f\u65b9\u6cd5\uff1a\u82e5\u7b2c\u4e00\u7ef4\u65f6\u95f4\u6233\u5927\u4e8e\u7b2c\u4e8c\u7ef4\uff0c\u4ea4\u6362\u5b83\u4eec\uff0c\u6309\u7b2c\u4e00\u7ef4\u6240\u5c5e\u5757\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\uff0c\u7b2c\u4e8c\u7ef4\u65f6\u95f4\u6233\u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\u6392\u5e8f\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u6307\u9488\u7684\u79fb\u52a8",children:"\u6307\u9488\u7684\u79fb\u52a8"}),"\n",(0,i.jsx)(n.h4,{id:"\u8fc7\u7a0b-2",children:"\u8fc7\u7a0b"}),"\n",(0,i.jsx)(n.p,{children:"\u5bb9\u6613\u60f3\u5230\uff0c\u6211\u4eec\u53ef\u4ee5\u6807\u8bb0\u88ab\u8ba1\u5165\u7b54\u6848\u7684\u70b9\uff0c\u8ba9\u6307\u9488\u76f4\u63a5\u5411\u76ee\u6807\u79fb\u52a8\uff0c\u540c\u65f6\u53d6\u53cd\u8def\u5f84\u4e0a\u7684\u70b9\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u4f46\u662f\uff0c\u8fd9\u6837\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u82e5\u6307\u9488\u4e00\u5f00\u59cb\u90fd\u5728 x \u4e0a\uff0c\u663e\u7136 x \u88ab\u6807\u8bb0\uff0c\u5f53\u4e24\u4e2a\u6307\u9488\u5411\u540c\u4e00\u5b50\u8282\u70b9\u79fb\u52a8\uff08\u8fd8\u6709\u8bb8\u591a\u60c5\u51b5\uff09\u65f6\uff0cx \u5e94\u8be5\u4e0d\u88ab\u6807\u8bb0\uff0c\u4f46\u5b9e\u9645\u60c5\u51b5\u662f x \u88ab\u6807\u8bb0\uff0c\u56e0\u4e3a\u4e24\u4e2a\u6307\u9488\u5206\u522b\u6807\u8bb0\u4e86\u4e00\u6b21\uff0c\u62b5\u6d88\u4e86\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u4f55\u89e3\u51b3\u5462\uff1f"}),"\n",(0,i.jsx)(n.p,{children:"\u6709\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u6027\u8d28\uff1a\u8fd9\u4e9b\u70b9\u80af\u5b9a\u662f\u67d0\u4e9b LCA\uff0c\u56e0\u4e3a LCA \u5904\u624d\u6709\u53ef\u80fd\u88ab\u91cd\u590d\u64a4\u9500\u5bfc\u81f4\u64a4\u9500\u5931\u8d25\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6240\u4ee5\u6211\u4eec\u6bcf\u6b21\u4e0d\u6807\u8bb0 LCA\uff0c\u5230\u9700\u8981\u8be2\u95ee\u7b54\u6848\u65f6\u518d\u5c06 LCA \u6807\u8bb0\uff0c\u7136\u540e\u518d\u64a4\u9500\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u5b9e\u73b0-1",children:"\u5b9e\u73b0"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"// \u53d6\u53cd\u8def\u5f84\u4e0a\u9664LCA\u4ee5\u5916\u7684\u6240\u6709\u8282\u70b9\nvoid move(int x, int y) {\n  if (dp[x] < dp[y]) swap(x, y);\n  while (dp[x] > dp[y]) update(x), x = fa[x];\n  while (x != y) update(x), update(y), x = fa[x], y = fa[y];\n  // x!=y\u4fdd\u8bc1LCA\u6ca1\u88ab\u53d6\u53cd\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5bf9\u4e8e\u6c42 LCA\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u6811\u5256\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u5206\u5757\u7684\u6b65\u9aa4\u653e\u5230\u6811\u5256\u7684\u7b2c\u4e00\u6b21 dfs \u91cc\u9762\uff0c\u65f6\u95f4\u6233\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7528\u7b2c\u4e8c\u6b21 dfs \u7684 dfs \u5e8f\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"int bl[100002], bls = 0;  // \u5c5e\u4e8e\u7684\u5757\uff0c\u5757\u7684\u6570\u91cf\nunsigned step;            // \u5757\u5927\u5c0f\nint fa[100002], dp[100002], hs[100002] = {0}, sz[100002] = {0};\n// \u7236\u8282\u70b9\uff0c\u6df1\u5ea6\uff0c\u91cd\u513f\u5b50\uff0c\u5927\u5c0f\nstack<int> sta;\n\nvoid dfs1(int x) {\n  sz[x] = 1;\n  unsigned ss = sta.size();\n  for (int i = head[x]; i; i = nxt[i])\n    if (ver[i] != fa[x]) {\n      fa[ver[i]] = x;\n      dp[ver[i]] = dp[x] + 1;\n      dfs1(ver[i]);\n      sz[x] += sz[ver[i]];\n      if (sz[ver[i]] > sz[hs[x]]) hs[x] = ver[i];\n      if (sta.size() - ss >= step) {\n        bls++;\n        while (sta.size() != ss) bl[sta.top()] = bls, sta.pop();\n      }\n    }\n  sta.push(x);\n}\n\n// main\nif (!sta.empty()) {\n  bls++;  // \u8fd9\u4e00\u884c\u53ef\u5199\u53ef\u4e0d\u5199\n  while (!sta.empty()) bl[sta.top()] = bls, sta.pop();\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u65f6\u95f4\u590d\u6742\u5ea6",children:"\u65f6\u95f4\u590d\u6742\u5ea6"}),"\n",(0,i.jsx)(n.p,{children:"\u91cd\u70b9\u5230\u4e86\uff0c\u8fd9\u91cc\u5173\u7cfb\u5230\u5757\u7684\u5927\u5c0f\u53d6\u503c\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u8bbe\u5757\u7684\u5927\u5c0f\u4e3a ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsx)(n.mi,{children:"t"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"unit"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6595em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"ni"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"t"})]})})]}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5bf9\u4e8e x \u6307\u9488\uff0c\u7531\u4e8e\u6bcf\u4e2a\u5757\u4e2d\u8282\u70b9\u7684\u8ddd\u79bb\u5728 ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsx)(n.mi,{children:"t"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"unit"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6595em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"ni"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"t"})]})})]})," \u5de6\u53f3\uff0c\u6bcf\u4e2a\u5757\u4e2d x \u6307\u9488\u79fb\u52a8 ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsxs)(n.msup,{children:[(0,i.jsx)(n.mi,{children:"t"}),(0,i.jsx)(n.mn,{children:"2"})]})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"unit^2"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.8141em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"ni"}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsx)(n.span,{className:"vlist-t",children:(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.8141em"},children:(0,i.jsxs)(n.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:"2"})})]})})})})})]})]})})]})," \u6b21\uff08",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsx)(n.mi,{children:"t"}),(0,i.jsx)(n.mo,{children:"\xd7"}),(0,i.jsx)(n.mi,{children:"d"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"s"}),(0,i.jsx)(n.mi,{children:"max"}),(0,i.jsx)(n.mo,{children:"\u2061"})]})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"unit\\times dis_{\\max}"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.7429em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"ni"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.8444em",verticalAlign:"-0.15em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"i"}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",children:"s"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:(0,i.jsxs)(n.span,{className:"mop mtight",children:[(0,i.jsx)(n.span,{className:"mtight",children:"m"}),(0,i.jsx)(n.span,{className:"mtight",children:"a"}),(0,i.jsx)(n.span,{className:"mtight",children:"x"})]})})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})]})]}),"\uff09\uff0c\u5171\u8ba1 ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mo,{children:"\xd7"}),(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsx)(n.mi,{children:"t"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"n\\times unit"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"n"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6595em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"ni"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"t"})]})]})]})," \u6b21\uff08",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsxs)(n.msup,{children:[(0,i.jsx)(n.mi,{children:"t"}),(0,i.jsx)(n.mn,{children:"2"})]}),(0,i.jsx)(n.mo,{children:"\xd7"}),(0,i.jsx)(n.mo,{stretchy:"false",children:"("}),(0,i.jsxs)(n.mfrac,{children:[(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsx)(n.mi,{children:"t"})]})]}),(0,i.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"unit^2 \\times (\\frac{n}{unit})"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.8974em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"ni"}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsx)(n.span,{className:"vlist-t",children:(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.8141em"},children:(0,i.jsxs)(n.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1.095em",verticalAlign:"-0.345em"}}),(0,i.jsx)(n.span,{className:"mopen",children:"("}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(n.span,{className:"mfrac",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsxs)(n.span,{className:"vlist",style:{height:"0.6954em"},children:[(0,i.jsxs)(n.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"u"}),(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"ni"}),(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"t"})]})})]}),(0,i.jsxs)(n.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(n.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"n"})})})]})]}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.345em"},children:(0,i.jsx)(n.span,{})})})]})}),(0,i.jsx)(n.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(n.span,{className:"mclose",children:")"})]})]})]}),"\uff09\uff1b"]}),"\n",(0,i.jsxs)(n.li,{children:["\u5bf9\u4e8e y \u6307\u9488\uff0c\u6bcf\u4e2a\u5757\u4e2d\u6700\u591a\u79fb\u52a8 ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"O"}),(0,i.jsx)(n.mo,{stretchy:"false",children:"("}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"O(n)"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),(0,i.jsx)(n.span,{className:"mopen",children:"("}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"n"}),(0,i.jsx)(n.span,{className:"mclose",children:")"})]})})]})," \u6b21\uff0c\u5171\u8ba1 ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsxs)(n.mfrac,{children:[(0,i.jsxs)(n.msup,{children:[(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mn,{children:"2"})]}),(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsx)(n.mi,{children:"t"})]})]})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\frac{n^2}{unit}"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1.3629em",verticalAlign:"-0.345em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(n.span,{className:"mfrac",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsxs)(n.span,{className:"vlist",style:{height:"1.0179em"},children:[(0,i.jsxs)(n.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"u"}),(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"ni"}),(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"t"})]})})]}),(0,i.jsxs)(n.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(n.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"n"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsx)(n.span,{className:"vlist-t",children:(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.8913em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.931em",marginRight:"0.0714em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.5em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size3 size1 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:"2"})})]})})})})})]})})})]})]}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.345em"},children:(0,i.jsx)(n.span,{})})})]})}),(0,i.jsx)(n.span,{className:"mclose nulldelimiter"})]})]})})]})," \u6b21\uff08",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mo,{children:"\xd7"}),(0,i.jsx)(n.mo,{stretchy:"false",children:"("}),(0,i.jsxs)(n.mfrac,{children:[(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mi,{children:"i"}),(0,i.jsx)(n.mi,{children:"t"})]})]}),(0,i.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"n \\times (\\frac{n}{unit})"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"n"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1.095em",verticalAlign:"-0.345em"}}),(0,i.jsx)(n.span,{className:"mopen",children:"("}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(n.span,{className:"mfrac",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsxs)(n.span,{className:"vlist",style:{height:"0.6954em"},children:[(0,i.jsxs)(n.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"u"}),(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"ni"}),(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"t"})]})})]}),(0,i.jsxs)(n.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(n.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"n"})})})]})]}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.345em"},children:(0,i.jsx)(n.span,{})})})]})}),(0,i.jsx)(n.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(n.span,{className:"mclose",children:")"})]})]})]}),"\uff09\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u52a0\u8d77\u6765\u5927\u6982\u5728\u6839\u53f7\u5904\u53d6\u5f97\u6700\u5c0f\u503c\uff08\u7531\u4e8e\u6811\u4e0a\u83ab\u961f\u5757\u7684\u5927\u5c0f\u4e0d\u56fa\u5b9a\uff0c\u6240\u4ee5\u4e0d\u4e00\u5b9a\u8981\u4e25\u683c\u6309\u7167\uff09\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u4f8b\u9898wc2013\u7cd6\u679c\u516c\u56ed",children:"\u4f8b\u9898\u300cWC2013\u300d\u7cd6\u679c\u516c\u56ed"}),"\n",(0,i.jsxs)(n.p,{children:["\u7531\u4e8e\u591a\u4e86\u65f6\u95f4\u7ef4\uff0c\u5757\u7684\u5927\u5c0f\u53d6\u5230 ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsxs)(n.msup,{children:[(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mn,{children:"0.6"})]})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"n^{0.6}"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.8141em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",children:"n"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsx)(n.span,{className:"vlist-t",children:(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.8141em"},children:(0,i.jsxs)(n.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:"0.6"})})})]})})})})})]})]})})]})," \u7684\u6837\u5b50\u5c31\u5dee\u4e0d\u591a\u4e86\u3002"]}),"\n",(0,i.jsx)(n.admonition,{title:"\u53c2\u8003\u4ee3\u7801",type:"info",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <stack>\nusing namespace std;\n\nint gi() {\n  int x, c, op = 1;\n  while (c = getchar(), c < '0' || c > '9')\n    if (c == '-') op = -op;\n  x = c ^ 48;\n  while (c = getchar(), c >= '0' && c <= '9')\n    x = (x << 3) + (x << 1) + (c ^ 48);\n  return x * op;\n}\n\nint head[100002], nxt[200004], ver[200004], tot = 0;\n\nvoid add(int x, int y) {\n  ver[++tot] = y, nxt[tot] = head[x], head[x] = tot;\n  ver[++tot] = x, nxt[tot] = head[y], head[y] = tot;\n}\n\nint bl[100002], bls = 0;\nunsigned step;\nint fa[100002], dp[100002], hs[100002] = {0}, sz[100002] = {0}, top[100002],\n                            id[100002];\nstack<int> sta;\n\nvoid dfs1(int x) {\n  sz[x] = 1;\n  unsigned ss = sta.size();\n  for (int i = head[x]; i; i = nxt[i])\n    if (ver[i] != fa[x]) {\n      fa[ver[i]] = x, dp[ver[i]] = dp[x] + 1;\n      dfs1(ver[i]);\n      sz[x] += sz[ver[i]];\n      if (sz[ver[i]] > sz[hs[x]]) hs[x] = ver[i];\n      if (sta.size() - ss >= step) {\n        bls++;\n        while (sta.size() != ss) bl[sta.top()] = bls, sta.pop();\n      }\n    }\n  sta.push(x);\n}\n\nint cnt = 0;\n\nvoid dfs2(int x, int hf) {\n  top[x] = hf, id[x] = ++cnt;\n  if (!hs[x]) return;\n  dfs2(hs[x], hf);\n  for (int i = head[x]; i; i = nxt[i])\n    if (ver[i] != fa[x] && ver[i] != hs[x]) dfs2(ver[i], ver[i]);\n}\n\nint lca(int x, int y) {\n  while (top[x] != top[y]) {\n    if (dp[top[x]] < dp[top[y]]) swap(x, y);\n    x = fa[top[x]];\n  }\n  return dp[x] < dp[y] ? x : y;\n}\n\nstruct qu {\n  int x, y, t, id;\n\n  bool operator<(const qu a) const {\n    return bl[x] == bl[a.x] ? (bl[y] == bl[a.y] ? t < a.t : bl[y] < bl[a.y])\n                            : bl[x] < bl[a.x];\n  }\n} q[100001];\n\nint qs = 0;\n\nstruct ch {\n  int x, y, b;\n} upd[100001];\n\nint ups = 0;\nlong long ans[100001];\nint b[100001] = {0};\nint a[100001];\nlong long w[100001];\nlong long v[100001];\nlong long now = 0;\nbool vis[100001] = {false};\n\nvoid back(int t) {\n  if (vis[upd[t].x]) {\n    now -= w[b[upd[t].y]--] * v[upd[t].y];\n    now += w[++b[upd[t].b]] * v[upd[t].b];\n  }\n  a[upd[t].x] = upd[t].b;\n}\n\nvoid change(int t) {\n  if (vis[upd[t].x]) {\n    now -= w[b[upd[t].b]--] * v[upd[t].b];\n    now += w[++b[upd[t].y]] * v[upd[t].y];\n  }\n  a[upd[t].x] = upd[t].y;\n}\n\nvoid update(int x) {\n  if (vis[x])\n    now -= w[b[a[x]]--] * v[a[x]];\n  else\n    now += w[++b[a[x]]] * v[a[x]];\n  vis[x] ^= 1;\n}\n\nvoid move(int x, int y) {\n  if (dp[x] < dp[y]) swap(x, y);\n  while (dp[x] > dp[y]) update(x), x = fa[x];\n  while (x != y) update(x), update(y), x = fa[x], y = fa[y];\n}\n\nint main() {\n  int n = gi(), m = gi(), k = gi();\n  step = (int)pow(n, 0.6);\n  for (int i = 1; i <= m; i++) v[i] = gi();\n  for (int i = 1; i <= n; i++) w[i] = gi();\n  for (int i = 1; i < n; i++) add(gi(), gi());\n  for (int i = 1; i <= n; i++) a[i] = gi();\n  for (int i = 1; i <= k; i++)\n    if (gi())\n      q[++qs].x = gi(), q[qs].y = gi(), q[qs].t = ups, q[qs].id = qs;\n    else\n      upd[++ups].x = gi(), upd[ups].y = gi();\n  for (int i = 1; i <= ups; i++) upd[i].b = a[upd[i].x], a[upd[i].x] = upd[i].y;\n  for (int i = ups; i; i--) back(i);\n  fa[1] = 1;\n  dfs1(1), dfs2(1, 1);\n  if (!sta.empty()) {\n    bls++;\n    while (!sta.empty()) bl[sta.top()] = bls, sta.pop();\n  }\n  for (int i = 1; i <= n; i++)\n    if (id[q[i].x] > id[q[i].y]) swap(q[i].x, q[i].y);\n  sort(q + 1, q + qs + 1);\n  int x = 1, y = 1, t = 0;\n  for (int i = 1; i <= qs; i++) {\n    if (x != q[i].x) move(x, q[i].x), x = q[i].x;\n    if (y != q[i].y) move(y, q[i].y), y = q[i].y;\n    int f = lca(x, y);\n    update(f);\n    while (t < q[i].t) change(++t);\n    while (t > q[i].t) back(t--);\n    ans[q[i].id] = now;\n    update(f);\n  }\n  for (int i = 1; i <= qs; i++) printf(\"%lld\\n\", ans[i]);\n  return 0;\n}\n"})})})]})}function d(s={}){const{wrapper:n}={...(0,l.R)(),...s.components};return n?(0,i.jsx)(n,{...s,children:(0,i.jsx)(h,{...s})}):h(s)}}}]);